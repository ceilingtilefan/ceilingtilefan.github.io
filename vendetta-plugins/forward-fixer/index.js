(function(g,i,d,e){"use strict";let c=[];const u=d.findByProps("sendMessage","editMessage"),f=d.findByProps("parse","parseToAST");function l(n){const o=/https:\/\/(?:ptb\.|canary\.)?discord(?:app)?\.com\/channels\/(\d+|@me)\/(\d+)\/(\d+)/g;return n.replace(o,function(a,r,s,t){return r==="@me"?`[Forwarded from DM - Message ${t}]`:`[Forwarded Message - ${t}]`})}function p(){if(!u?.sendMessage){e.logger.warn("Could not find sendMessage function");return}const n=i.before("sendMessage",u,function(o){const[a,r]=o;if(r?.content){const s=r.content,t=l(s);s!==t&&(e.logger.log("Fixed forwarded message content"),r.content=t)}});c.push(n)}function h(){if(!f?.parse){e.logger.warn("Could not find message parser");return}const n=i.after("parse",f,function(o,a){if(typeof o[0]=="string"){const r=o[0],s=l(r);if(r!==s)return e.logger.log("Fixed parsed message content"),a}return a});c.push(n)}var m={onLoad:function(){e.logger.log("Forward Fixer plugin loaded!");try{p(),h(),e.logger.log("Successfully patched message functions")}catch(n){e.logger.error("Failed to patch message functions:",n)}},onUnload:function(){e.logger.log("Forward Fixer plugin unloaded!"),c.forEach(function(n){try{n()}catch(o){e.logger.error("Failed to remove patch:",o)}}),c=[]}};return g.default=m,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.patcher,vendetta.metro,vendetta);
